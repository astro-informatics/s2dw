<HTML>
<HEAD>
   <TITLE> program s2dw_maskapply (generated by f90doc) </TITLE>
  <LINK rel="stylesheet" href="stylesheet.css" type="text/css" /> </HEAD>
<H1> Program s2dw_maskapply </H1>
<PRE>program s2dw_maskapply

        ! Uses
    use <A HREF="s2dw_types_mod.html">s2dw_types_mod</A>
    use <A HREF="s2dw_error_mod.html">s2dw_error_mod</A>
    use <A HREF="s2dw_core_mod.html">s2dw_core_mod</A>
    use <A HREF="s2dw_fileio_mod.html">s2dw_fileio_mod</A>
    use <A HREF="healpix_types.html">healpix_types</A>, only: HPX_DBADVAL

        ! Calls
    call parse_options
    call s2dw_core_free_wavdyn
    call s2dw_error
    call s2dw_fileio_fits_wav_read
    call s2dw_fileio_fits_wav_write
    call s2dw_fileio_matlab_wav_read
    call s2dw_fileio_matlab_wav_write

        ! Variables
    real (kind=dp), parameter :: <A HREF="s2dw_maskapply.html#var_fits_display_grey_magic_number">FITS_DISPLAY_GREY_MAGIC_NUMBER</A> = HPX_DBADVAL
    type (s2dw_wav_abg), allocatable, dimension (:) :: <A HREF="s2dw_maskapply.html#var_wavdyn_data">wavdyn_data</A>
    type (s2dw_wav_abg), allocatable, dimension (:) :: <A HREF="s2dw_maskapply.html#var_wavdyn_mask">wavdyn_mask</A>
    complex (kind=dpc), allocatable, dimension (:,:) :: <A HREF="s2dw_maskapply.html#var_scoeff_data">scoeff_data</A>
    complex (kind=dpc), allocatable, dimension (:,:) :: <A HREF="s2dw_maskapply.html#var_scoeff_mask">scoeff_mask</A>
    integer :: <A HREF="s2dw_maskapply.html#var_j">J</A>
    integer :: <A HREF="s2dw_maskapply.html#var_j_check">J_check</A>
    integer :: <A HREF="s2dw_maskapply.html#var_jj">jj</A>
    integer :: <A HREF="s2dw_maskapply.html#var_l">L</A>
    integer :: <A HREF="s2dw_maskapply.html#var_l_check">L_check</A>
    integer :: <A HREF="s2dw_maskapply.html#var_n">N</A>
    integer :: <A HREF="s2dw_maskapply.html#var_n_check">N_check</A>
    integer :: <A HREF="s2dw_maskapply.html#var_bl_scoeff">bl_scoeff</A>
    real (kind=dp) :: <A HREF="s2dw_maskapply.html#var_alpha">alpha</A>
    real (kind=dp) :: <A HREF="s2dw_maskapply.html#var_alpha_check">alpha_check</A>
    character (len=STRING_LEN) :: <A HREF="s2dw_maskapply.html#var_filename_data">filename_data</A>
    character (len=STRING_LEN) :: <A HREF="s2dw_maskapply.html#var_filename_mask">filename_mask</A>
    character (len=STRING_LEN) :: <A HREF="s2dw_maskapply.html#var_filename_out">filename_out</A>
    character (len=*), parameter :: <A HREF="s2dw_maskapply.html#var_file_type_fits">FILE_TYPE_FITS</A> = 'fits'
    character (len=*), parameter :: <A HREF="s2dw_maskapply.html#var_file_type_mat">FILE_TYPE_MAT</A> = 'm'
    character (len=STRING_LEN) :: <A HREF="s2dw_maskapply.html#var_file_type">file_type</A> = FILE_TYPE_FITS
    integer :: <A HREF="s2dw_maskapply.html#var_s2dw_fits_filename_ext_len">S2DW_FITS_FILENAME_EXT_LEN</A> = 4
    logical :: <A HREF="s2dw_maskapply.html#var_display">display</A> = .true.

        ! Subroutines and functions
    subroutine <A HREF="s2dw_maskapply.html#subroutine_parse_options">parse_options</A> ()

end program s2dw_maskapply
</PRE>
 Apply a mask (containing only ones and zeros) to a set of wavelet 
 coefficients.  The output is the product of the mask and data coefficients.
 If the display status is set then the masked output coefficients are 
 overwritten with a magic number that appears grey when plotted. Output 
 coefficients produced with the display option set should <STRONG>only</STRONG> be used for 
 display purposes, and <STRONG>not</STRONG> for any subsequent analysis.
<P>
 Usage: s2dw_maskapply
   <UL>
   <LI>  [-help]: Display usage information.
   <LI>  [-data filename_data]: Name of input file containing wavelet 
     coefficients of data to mask.
   <LI>  [-mask filename_mask]: Name of input file containing wavelet 
     coefficients of mask to apply.
   <LI>  [-out filename_out]: Name of output file to write containing masked 
     wavelet coefficients.
   <LI>  [-file_type file_type (fits; m)]: String specifying type of output 
     S2DW file to write  (fits or matlab m) [default=fits].
   <LI>  [-display display]:  Logical specify whether to produce output
     coefficients for display purposes only, in which case the masked
     values are set to a magic number so that they appear grey when plotted.
   </UL>
<P>
<STRONG>Author:</STRONG> S. M. Feeney (stephen.feeney.09@ucl.ac.uk)
<P>
<STRONG>Version:</STRONG> 0.1 - February 2012

<HR><H2> Description of Variables </H2>
<A NAME="var_fits_display_grey_magic_number"><H3>FITS_DISPLAY_GREY_MAGIC_NUMBER</H3></A>
<PRE>real (kind=dp), parameter :: FITS_DISPLAY_GREY_MAGIC_NUMBER = HPX_DBADVAL
</PRE>
<A NAME="var_wavdyn_data"><H3>wavdyn_data</H3></A>
<PRE>type (s2dw_wav_abg), allocatable, dimension (:) :: wavdyn_data
</PRE>
<A NAME="var_wavdyn_mask"><H3>wavdyn_mask</H3></A>
<PRE>type (s2dw_wav_abg), allocatable, dimension (:) :: wavdyn_mask
</PRE>
<A NAME="var_scoeff_data"><H3>scoeff_data</H3></A>
<PRE>complex (kind=dpc), allocatable, dimension (:,:) :: scoeff_data
</PRE>
<A NAME="var_scoeff_mask"><H3>scoeff_mask</H3></A>
<PRE>complex (kind=dpc), allocatable, dimension (:,:) :: scoeff_mask
</PRE>
<A NAME="var_j"><H3>J</H3></A>
<PRE>integer :: J
</PRE>
<A NAME="var_j_check"><H3>J_check</H3></A>
<PRE>integer :: J_check
</PRE>
<A NAME="var_jj"><H3>jj</H3></A>
<PRE>integer :: jj
</PRE>
<A NAME="var_l"><H3>L</H3></A>
<PRE>integer :: L
</PRE>
<A NAME="var_l_check"><H3>L_check</H3></A>
<PRE>integer :: L_check
</PRE>
<A NAME="var_n"><H3>N</H3></A>
<PRE>integer :: N
</PRE>
<A NAME="var_n_check"><H3>N_check</H3></A>
<PRE>integer :: N_check
</PRE>
<A NAME="var_bl_scoeff"><H3>bl_scoeff</H3></A>
<PRE>integer :: bl_scoeff
</PRE>
<A NAME="var_alpha"><H3>alpha</H3></A>
<PRE>real (kind=dp) :: alpha
</PRE>
<A NAME="var_alpha_check"><H3>alpha_check</H3></A>
<PRE>real (kind=dp) :: alpha_check
</PRE>
<A NAME="var_filename_data"><H3>filename_data</H3></A>
<PRE>character (len=STRING_LEN) :: filename_data
</PRE>
<A NAME="var_filename_mask"><H3>filename_mask</H3></A>
<PRE>character (len=STRING_LEN) :: filename_mask
</PRE>
<A NAME="var_filename_out"><H3>filename_out</H3></A>
<PRE>character (len=STRING_LEN) :: filename_out
</PRE>
<A NAME="var_file_type_fits"><H3>FILE_TYPE_FITS</H3></A>
<PRE>character (len=*), parameter :: FILE_TYPE_FITS = 'fits'
</PRE>
<A NAME="var_file_type_mat"><H3>FILE_TYPE_MAT</H3></A>
<PRE>character (len=*), parameter :: FILE_TYPE_MAT = 'm'
</PRE>
<A NAME="var_file_type"><H3>file_type</H3></A>
<PRE>character (len=STRING_LEN) :: file_type = FILE_TYPE_FITS
</PRE>
<A NAME="var_s2dw_fits_filename_ext_len"><H3>S2DW_FITS_FILENAME_EXT_LEN</H3></A>
<PRE>integer :: S2DW_FITS_FILENAME_EXT_LEN = 4
</PRE>
<A NAME="var_display"><H3>display</H3></A>
<PRE>logical :: display = .true.
</PRE>

<HR><H2> Description of Subroutines and Functions </H2>
<A NAME="subroutine_parse_options"><H3>parse_options</H3></A>
<PRE>subroutine parse_options ()
    ! Calls: getArgument
end subroutine parse_options
</PRE>
 Parse the options passed when program called.
<P>
<STRONG>Author:</STRONG> S. M. Feeney (stephen.feeney.09@ucl.ac.uk)
<P>
<STRONG>Version:</STRONG> 0.1 - February 2012
</HTML>
