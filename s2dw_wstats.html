<HTML>
<HEAD>
   <TITLE> program s2dw_wstats (generated by f90doc) </TITLE>
  <LINK rel="stylesheet" href="stylesheet.css" type="text/css" /> </HEAD>
<H1> Program s2dw_wstats </H1>
<PRE>program s2dw_wstats

        ! Uses
    use <A HREF="s2_sky_mod.html">s2_sky_mod</A>
    use <A HREF="s2dw_types_mod.html">s2dw_types_mod</A>
    use <A HREF="s2dw_error_mod.html">s2dw_error_mod</A>
    use <A HREF="s2dw_core_mod.html">s2dw_core_mod</A>
    use <A HREF="s2dw_fileio_mod.html">s2dw_fileio_mod</A>
    use <A HREF="s2dw_stat_mod.html">s2dw_stat_mod</A>

        ! Calls
    call parse_options
    call s2_sky_compute_alm
    call s2_sky_free
    call s2_sky_get_alm
    call s2dw_core_analysis_flm2wav_dynamic
    call s2dw_core_free_wavdyn
    call s2dw_core_init_directionality
    call s2dw_core_init_kernels
    call s2dw_error
    call s2dw_fileio_fits_wav_read
    call s2dw_stat_moments
    call s2dw_stat_moments_write

        ! Variables
    character (len=STRING_LEN) :: <A HREF="s2dw_wstats.html#var_filename_in">filename_in</A>
    character (len=STRING_LEN) :: <A HREF="s2dw_wstats.html#var_filename_out">filename_out</A>
    character (len=STRING_LEN) :: <A HREF="s2dw_wstats.html#var_filename_mask">filename_mask</A>
    character (len=STRING_LEN), allocatable, dimension (:) :: <A HREF="s2dw_wstats.html#var_description">description</A>
    character (len=STRING_LEN) :: <A HREF="s2dw_wstats.html#var_line">line</A>
    complex (kind=dpc), allocatable, dimension (:,:) :: <A HREF="s2dw_wstats.html#var_flm">flm</A>
    complex (kind=spc), allocatable, dimension (:,:) :: <A HREF="s2dw_wstats.html#var_flm_sp">flm_sp</A>
    real (kind=dp), allocatable, dimension (:,:) :: <A HREF="s2dw_wstats.html#var_k_gamma">K_gamma</A>
    real (kind=dp), allocatable, dimension (:) :: <A HREF="s2dw_wstats.html#var_phi2">Phi2</A>
    complex (kind=dpc), allocatable, dimension (:,:) :: <A HREF="s2dw_wstats.html#var_slm">Slm</A>
    real (kind=dp), allocatable, dimension (:) :: <A HREF="s2dw_wstats.html#var_admiss">admiss</A>
    type (s2dw_wav_abg), allocatable, dimension (:) :: <A HREF="s2dw_wstats.html#var_wavdyn">wavdyn</A>
    type (s2dw_wav_abg), allocatable, dimension (:) :: <A HREF="s2dw_wstats.html#var_wavdyn_mask">wavdyn_mask</A>
    complex (kind=dpc), allocatable, dimension (:,:) :: <A HREF="s2dw_wstats.html#var_scoeff">scoeff</A>
    complex (kind=dpc), allocatable, dimension (:,:) :: <A HREF="s2dw_wstats.html#var_scoeff_mask">scoeff_mask</A>
    type (s2_sky) :: <A HREF="s2dw_wstats.html#var_sky">sky</A>
    real (kind=dp), allocatable, dimension (:,:) :: <A HREF="s2dw_wstats.html#var_mu">mu</A>
    real (kind=dp), allocatable, dimension (:,:) :: <A HREF="s2dw_wstats.html#var_var">var</A>
    real (kind=dp), allocatable, dimension (:,:) :: <A HREF="s2dw_wstats.html#var_skew">skew</A>
    real (kind=dp), allocatable, dimension (:,:) :: <A HREF="s2dw_wstats.html#var_kur">kur</A>
    real (kind=dp), allocatable, dimension (:,:) :: <A HREF="s2dw_wstats.html#var_five">five</A>
    real (kind=dp), allocatable, dimension (:,:) :: <A HREF="s2dw_wstats.html#var_six">six</A>
    integer :: <A HREF="s2dw_wstats.html#var_isim">isim</A>
    integer :: <A HREF="s2dw_wstats.html#var_nsim">nsim</A>
    integer :: <A HREF="s2dw_wstats.html#var_j">J</A>
    integer :: <A HREF="s2dw_wstats.html#var_j_check">J_check</A>
    integer :: <A HREF="s2dw_wstats.html#var_j_max">J_max</A>
    integer :: <A HREF="s2dw_wstats.html#var_b">B</A>
    integer :: <A HREF="s2dw_wstats.html#var_b_check">B_check</A>
    integer :: <A HREF="s2dw_wstats.html#var_n">N</A> = 3
    integer :: <A HREF="s2dw_wstats.html#var_n_check">N_check</A>
    integer :: <A HREF="s2dw_wstats.html#var_bl_scoeff">bl_scoeff</A>
    real (kind=dp) :: <A HREF="s2dw_wstats.html#var_alpha">alpha</A> = 2d0
    real (kind=dp) :: <A HREF="s2dw_wstats.html#var_alpha_check">alpha_check</A>
    logical :: <A HREF="s2dw_wstats.html#var_admiss_pass">admiss_pass</A>
    logical :: <A HREF="s2dw_wstats.html#var_use_jmax">use_Jmax</A> = .true.
    logical :: <A HREF="s2dw_wstats.html#var_apply_mask">apply_mask</A> = .false.
    integer :: <A HREF="s2dw_wstats.html#var_fail">fail</A> = 0
    integer :: <A HREF="s2dw_wstats.html#var_fileid">fileid</A>
    integer :: <A HREF="s2dw_wstats.html#var_iostat">iostat</A>
    character (len=STRING_LEN) :: <A HREF="s2dw_wstats.html#var_error_string">error_string</A>

        ! Subroutines and functions
    subroutine <A HREF="s2dw_wstats.html#subroutine_parse_options">parse_options</A> ()

end program s2dw_wstats
</PRE>
 Compute wavelet coefficient statistics from a map (and then discard
 wavelet coefficients).
<P>
 Usage: s2dw_wstats
   <UL>
   <LI>  [-help]: Display usage information.
   <LI>  [-inp filename_in]: Name of input file containing list of maps to 
     compute wavelet coefficients and then statistics of.
   <LI>  [-mask filename_mask]: Name of input file containing mask,
     defined in wavelet space, to apply when computing moments.
   <LI>  [-out filename_out]: Name of output statistic file.
   <LI>  [-B B]: Harmonic band limit (if not specified set to 2*nside).
   <LI>  [-N N]: Azimuthal band limit [default=3].
   <LI>  [-alpha alpha]: Basis dilation factor [default=2].
   <LI>  [-J J]: Maximum analysis scale [default=Jmax].
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen (mcewen@mrao.cam.ac.uk)

<HR><H2> Description of Variables </H2>
<A NAME="var_filename_in"><H3>filename_in</H3></A>
<PRE>character (len=STRING_LEN) :: filename_in
</PRE>
<A NAME="var_filename_out"><H3>filename_out</H3></A>
<PRE>character (len=STRING_LEN) :: filename_out
</PRE>
<A NAME="var_filename_mask"><H3>filename_mask</H3></A>
<PRE>character (len=STRING_LEN) :: filename_mask
</PRE>
<A NAME="var_description"><H3>description</H3></A>
<PRE>character (len=STRING_LEN), allocatable, dimension (:) :: description
</PRE>
<A NAME="var_line"><H3>line</H3></A>
<PRE>character (len=STRING_LEN) :: line
</PRE>
<A NAME="var_flm"><H3>flm</H3></A>
<PRE>complex (kind=dpc), allocatable, dimension (:,:) :: flm
</PRE>
<A NAME="var_flm_sp"><H3>flm_sp</H3></A>
<PRE>complex (kind=spc), allocatable, dimension (:,:) :: flm_sp
</PRE>
<A NAME="var_k_gamma"><H3>K_gamma</H3></A>
<PRE>real (kind=dp), allocatable, dimension (:,:) :: K_gamma
</PRE>
<A NAME="var_phi2"><H3>Phi2</H3></A>
<PRE>real (kind=dp), allocatable, dimension (:) :: Phi2
</PRE>
<A NAME="var_slm"><H3>Slm</H3></A>
<PRE>complex (kind=dpc), allocatable, dimension (:,:) :: Slm
</PRE>
<A NAME="var_admiss"><H3>admiss</H3></A>
<PRE>real (kind=dp), allocatable, dimension (:) :: admiss
</PRE>
<A NAME="var_wavdyn"><H3>wavdyn</H3></A>
<PRE>type (s2dw_wav_abg), allocatable, dimension (:) :: wavdyn
</PRE>
<A NAME="var_wavdyn_mask"><H3>wavdyn_mask</H3></A>
<PRE>type (s2dw_wav_abg), allocatable, dimension (:) :: wavdyn_mask
</PRE>
<A NAME="var_scoeff"><H3>scoeff</H3></A>
<PRE>complex (kind=dpc), allocatable, dimension (:,:) :: scoeff
</PRE>
<A NAME="var_scoeff_mask"><H3>scoeff_mask</H3></A>
<PRE>complex (kind=dpc), allocatable, dimension (:,:) :: scoeff_mask
</PRE>
<A NAME="var_sky"><H3>sky</H3></A>
<PRE>type (s2_sky) :: sky
</PRE>
<A NAME="var_mu"><H3>mu</H3></A>
<PRE>real (kind=dp), allocatable, dimension (:,:) :: mu
</PRE>
<A NAME="var_var"><H3>var</H3></A>
<PRE>real (kind=dp), allocatable, dimension (:,:) :: var
</PRE>
<A NAME="var_skew"><H3>skew</H3></A>
<PRE>real (kind=dp), allocatable, dimension (:,:) :: skew
</PRE>
<A NAME="var_kur"><H3>kur</H3></A>
<PRE>real (kind=dp), allocatable, dimension (:,:) :: kur
</PRE>
<A NAME="var_five"><H3>five</H3></A>
<PRE>real (kind=dp), allocatable, dimension (:,:) :: five
</PRE>
<A NAME="var_six"><H3>six</H3></A>
<PRE>real (kind=dp), allocatable, dimension (:,:) :: six
</PRE>
<A NAME="var_isim"><H3>isim</H3></A>
<PRE>integer :: isim
</PRE>
<A NAME="var_nsim"><H3>nsim</H3></A>
<PRE>integer :: nsim
</PRE>
<A NAME="var_j"><H3>J</H3></A>
<PRE>integer :: J
</PRE>
<A NAME="var_j_check"><H3>J_check</H3></A>
<PRE>integer :: J_check
</PRE>
<A NAME="var_j_max"><H3>J_max</H3></A>
<PRE>integer :: J_max
</PRE>
<A NAME="var_b"><H3>B</H3></A>
<PRE>integer :: B
</PRE>
<A NAME="var_b_check"><H3>B_check</H3></A>
<PRE>integer :: B_check
</PRE>
<A NAME="var_n"><H3>N</H3></A>
<PRE>integer :: N = 3
</PRE>
<A NAME="var_n_check"><H3>N_check</H3></A>
<PRE>integer :: N_check
</PRE>
<A NAME="var_bl_scoeff"><H3>bl_scoeff</H3></A>
<PRE>integer :: bl_scoeff
</PRE>
<A NAME="var_alpha"><H3>alpha</H3></A>
<PRE>real (kind=dp) :: alpha = 2d0
</PRE>
<A NAME="var_alpha_check"><H3>alpha_check</H3></A>
<PRE>real (kind=dp) :: alpha_check
</PRE>
<A NAME="var_admiss_pass"><H3>admiss_pass</H3></A>
<PRE>logical :: admiss_pass
</PRE>
<A NAME="var_use_jmax"><H3>use_Jmax</H3></A>
<PRE>logical :: use_Jmax = .true.
</PRE>
<A NAME="var_apply_mask"><H3>apply_mask</H3></A>
<PRE>logical :: apply_mask = .false.
</PRE>
<A NAME="var_fail"><H3>fail</H3></A>
<PRE>integer :: fail = 0
</PRE>
<A NAME="var_fileid"><H3>fileid</H3></A>
<PRE>integer :: fileid
</PRE>
<A NAME="var_iostat"><H3>iostat</H3></A>
<PRE>integer :: iostat
</PRE>
<A NAME="var_error_string"><H3>error_string</H3></A>
<PRE>character (len=STRING_LEN) :: error_string
</PRE>

<HR><H2> Description of Subroutines and Functions </H2>
<A NAME="subroutine_parse_options"><H3>parse_options</H3></A>
<PRE>subroutine parse_options ()
    ! Calls: getArgument
end subroutine parse_options
</PRE>
 Parses the options passed when program called.
<P>
<STRONG>Author:</STRONG> J. D. McEwen (mcewen@mrao.cam.ac.uk)
<P>
<STRONG>Version:</STRONG> 0.1 - November 2007
</HTML>
