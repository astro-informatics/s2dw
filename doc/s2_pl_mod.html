<HTML>
<HEAD>
   <TITLE> module s2_pl_mod (generated by f90doc) </TITLE>
  <LINK rel="stylesheet" href="stylesheet.css" type="text/css" /> </HEAD>
<H1> Module s2_pl_mod </H1>
<PRE>module s2_pl_mod

        ! Uses
    use <A HREF="s2_types_mod.html">s2_types_mod</A>
    use <A HREF="s2_error_mod.html">s2_error_mod</A>

        ! Types
    public type <A HREF="s2_pl_mod.html#type_s2_pl">s2_pl</A>

        ! Interfaces
    public interface <A HREF="s2_pl_mod.html#interface_s2_pl_init">s2_pl_init</A>
    public interface <A HREF="s2_pl_mod.html#interface_s2_pl_conv">s2_pl_conv</A>

        ! Subroutines and functions
    private function <A HREF="s2_pl_mod.html#function_s2_pl_init_array">s2_pl_init_array</A> (data) result (pl)
    private function <A HREF="s2_pl_mod.html#function_s2_pl_init_array_const">s2_pl_init_array_const</A> (const, lmax) result (pl)
    private function <A HREF="s2_pl_mod.html#function_s2_pl_init_copy">s2_pl_init_copy</A> (orig) result (copy)
    private function <A HREF="s2_pl_mod.html#function_s2_pl_init_copy_truncate">s2_pl_init_copy_truncate</A> (orig, lmax) result (copy)
    public function <A HREF="s2_pl_mod.html#function_s2_pl_init_guassian">s2_pl_init_guassian</A> (fwhm, lmax) result (pl)
    public subroutine <A HREF="s2_pl_mod.html#subroutine_s2_pl_free">s2_pl_free</A> (pl)
    public function <A HREF="s2_pl_mod.html#function_s2_pl_add">s2_pl_add</A> (pl1, pl2) result (pl_sum)
    private subroutine <A HREF="s2_pl_mod.html#subroutine_s2_pl_conv_alm">s2_pl_conv_alm</A> (pl, alm)
    private subroutine <A HREF="s2_pl_mod.html#subroutine_s2_pl_conv_pl">s2_pl_conv_pl</A> (pl1, pl2)
    public function <A HREF="s2_pl_mod.html#function_s2_pl_get_init">s2_pl_get_init</A> (pl) result (init)
    public function <A HREF="s2_pl_mod.html#function_s2_pl_get_lmax">s2_pl_get_lmax</A> (pl) result (lmax)
    public subroutine <A HREF="s2_pl_mod.html#subroutine_s2_pl_get_spec">s2_pl_get_spec</A> (pl, pl_spec)
    public function <A HREF="s2_pl_mod.html#function_s2_pl_get_spec_l">s2_pl_get_spec_l</A> (pl, l) result (pl_val)

end module s2_pl_mod
</PRE>
 Provides functionality to support and manipulate a p(l) (l spectrum) 
 function.
<P>
<STRONG>Author:</STRONG> J. D. McEwen (mcewen@mrao.cam.ac.uk)
<P>
<STRONG>Version:</STRONG> 0.1 August 2004

<HR><H2> Description of Types </H2>
<A NAME="type_s2_pl"><H3>s2_pl</H3></A>
<PRE>public type s2_pl
    private
    logical :: init = .false.
    integer :: lmax = 0
    real (kind=s2_sp), allocatable, dimension (:) :: pl
end type s2_pl
</PRE>

<HR><H2> Description of Interfaces </H2>
<A NAME="interface_s2_pl_init"><H3>s2_pl_init</H3></A>
<PRE>public interface s2_pl_init
    module procedure <A HREF="#function_s2_pl_init_array">s2_pl_init_array</A>
    module procedure <A HREF="#function_s2_pl_init_array_const">s2_pl_init_array_const</A>
    module procedure <A HREF="#function_s2_pl_init_copy">s2_pl_init_copy</A>
    module procedure <A HREF="#function_s2_pl_init_copy_truncate">s2_pl_init_copy_truncate</A>
end interface s2_pl_init
</PRE>
<A NAME="interface_s2_pl_conv"><H3>s2_pl_conv</H3></A>
<PRE>public interface s2_pl_conv
    module procedure <A HREF="#subroutine_s2_pl_conv_alm">s2_pl_conv_alm</A>
    module procedure <A HREF="#subroutine_s2_pl_conv_pl">s2_pl_conv_pl</A>
end interface s2_pl_conv
</PRE>

<HR><H2> Description of Subroutines and Functions </H2>
<A NAME="function_s2_pl_init_array"><H3>s2_pl_init_array</H3></A>
<PRE>private function s2_pl_init_array (data) result (pl)
    real (kind=s2_sp), intent(in), dimension (:) :: data
    type (s2_pl) :: pl
    ! Calls: s2_error
end function s2_pl_init_array
</PRE>
 Initiliase a pl from a array of data values.
<P>
 Variables:
   <UL>
   <LI>  data: Data array to initialise pl spectrum.
   <LI>  pl: Initialised pl.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_s2_pl_init_array_const"><H3>s2_pl_init_array_const</H3></A>
<PRE>private function s2_pl_init_array_const (const, lmax) result (pl)
    real (kind=s2_sp), intent(in) :: const
    integer, intent(in) :: lmax
    type (s2_pl) :: pl
    ! Calls: s2_error
end function s2_pl_init_array_const
</PRE>
 Initiliase a pl with a constant value over all l.
<P>
 Variables:
   <UL>
   <LI>  const: Constant values used to  array to initialise pl spectrum.
   <LI>  lmax: Lmax of the constructed pl spectrum.
   <LI>  pl: Initialised pl.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 February 2005
<A NAME="function_s2_pl_init_copy"><H3>s2_pl_init_copy</H3></A>
<PRE>private function s2_pl_init_copy (orig) result (copy)
    type (s2_pl), intent(in) :: orig
    type (s2_pl) :: copy
    ! Calls: s2_error
end function s2_pl_init_copy
</PRE>
 Initialse a pl from a copy of another pl.
<P>
 Variables:
   <UL>
   <LI>  orig: Original pl to copy.
   <LI>  copy: Copied pl.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_s2_pl_init_copy_truncate"><H3>s2_pl_init_copy_truncate</H3></A>
<PRE>private function s2_pl_init_copy_truncate (orig, lmax) result (copy)
    type (s2_pl), intent(in) :: orig
    integer, intent(in) :: lmax
    type (s2_pl) :: copy
    ! Calls: s2_error
end function s2_pl_init_copy_truncate
</PRE>
 Initialse a pl from a copy of another pl but truncate to a lower lmax.
<P>
 Variables:
   <UL>
   <LI>  orig: Original pl to copy.
   <LI>  lmax: Lmax of copy pl to truncate to.
   <LI>  copy: Copied pl.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 Januray 2005
<A NAME="function_s2_pl_init_guassian"><H3>s2_pl_init_guassian</H3></A>
<PRE>public function s2_pl_init_guassian (fwhm, lmax) result (pl)
    real (kind=s2_sp), intent(in) :: fwhm
    integer, intent(in) :: lmax
    type (s2_pl) :: pl
    ! Calls: s2_error
end function s2_pl_init_guassian
</PRE>
 Initiliase a pl with a Gaussian beam with specified full width half max.
<P>
 Notes:
   <UL>
   <LI>  Gaussian beam defined as exp(-l(l+1)*sigma2), where 
     sigma2 = fwhm**2.0e0 / (8.0e0 * log(2.0e0)).
<P>
   </UL>
 Variables:
   <UL>
   <LI>  fwhm: Full width half maximum of Gaussian beam (in radians).
   <LI>  lmax: Lmax of the constructed pl spectrum.
   <LI>  pl: Initialised pl with Gaussian beam.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 May 2005
<A NAME="subroutine_s2_pl_free"><H3>s2_pl_free</H3></A>
<PRE>public subroutine s2_pl_free (pl)
    type (s2_pl), intent(inout) :: pl
    ! Calls: s2_error
end subroutine s2_pl_free
</PRE>
 Free all data associated with an initialised pl and reset all other 
 attributes.
<P>
 Variables:
   <UL>
   <LI>  pl: The pl to free.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_s2_pl_add"><H3>s2_pl_add</H3></A>
<PRE>public function s2_pl_add (pl1, pl2) result (pl_sum)
    type (s2_pl), intent(in) :: pl1
    type (s2_pl), intent(in) :: pl2
    type (s2_pl) :: pl_sum
    ! Calls: s2_error
end function s2_pl_add
</PRE>
 All two pl spectrums.
<P>
 Notes:
   <UL>
   <LI>  The returned pl_sum object is initialised herein and must be freed 
     by the calling routine.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  pl1: First pl spectrum to be added.
   <LI>  pl2: Second pl spectru to be added.
   <LI>  pl_sum: Summed spectrum.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 May 2005
<A NAME="subroutine_s2_pl_conv_alm"><H3>s2_pl_conv_alm</H3></A>
<PRE>private subroutine s2_pl_conv_alm (pl, alm)
    type (s2_pl), intent(in) :: pl
    complex (kind=s2_spc), intent(inout), dimension (0:,0:) :: alm
    ! Calls: s2_error
end subroutine s2_pl_conv_alm
</PRE>
 Convolve an alm with the pl.  The original alm is overwritten with 
 the convolved alm on ouput.  If length of alm is shorter than pl then
 neglect larger pl values.  If length of alm is greater than pl then
 effectivly pad the pl with zeros, i.e. set high l alm values to zero.
<P>
 Variables:
   <UL>
   <LI>  pl: Pl to convolve.
   <LI>  alm: Alm to convolve.  Overwritten with new alm on output.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="subroutine_s2_pl_conv_pl"><H3>s2_pl_conv_pl</H3></A>
<PRE>private subroutine s2_pl_conv_pl (pl1, pl2)
    type (s2_pl), intent(inout) :: pl1
    type (s2_pl), intent(in) :: pl2
    ! Calls: s2_error
end subroutine s2_pl_conv_pl
</PRE>
 Convolve two power spectra.  Pl1 is overwritten with the convolved 
 spectrum on output.  (Spectra must have same lmax.)
<P>
 Variables:
   <UL>
   <LI>  pl1: First pl to convolve.  Overwritten with new spectrum on output.
   <LI>  pl2: Second pl to convolve.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 May 2005
<A NAME="function_s2_pl_get_init"><H3>s2_pl_get_init</H3></A>
<PRE>public function s2_pl_get_init (pl) result (init)
    type (s2_pl), intent(in) :: pl
    logical :: init
end function s2_pl_get_init
</PRE>
 Get init variable from the passed pl.
<P>
 Variables:
   <UL>
   <LI>  pl: Pl object to get the variable of.
   <LI>  init: Object init variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_s2_pl_get_lmax"><H3>s2_pl_get_lmax</H3></A>
<PRE>public function s2_pl_get_lmax (pl) result (lmax)
    type (s2_pl), intent(in) :: pl
    integer :: lmax
    ! Calls: s2_error
end function s2_pl_get_lmax
</PRE>
 Get lmax variable from the passed pl.
<P>
 Variables:
   <UL>
   <LI>  pl: Pl object to get the variable of.
   <LI>  lmax: Object lmax variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="subroutine_s2_pl_get_spec"><H3>s2_pl_get_spec</H3></A>
<PRE>public subroutine s2_pl_get_spec (pl, pl_spec)
    type (s2_pl), intent(in) :: pl
    real (kind=s2_sp), intent(out), dimension (:) :: pl_spec
    ! Calls: s2_error
end subroutine s2_pl_get_spec
</PRE>
 Get pl spectrum variable from the passed pl.
<P>
 Variables:
   <UL>
   <LI>  pl: Pl object to get the variable of.
   <LI>  pl_spec: Object pl spec variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_s2_pl_get_spec_l"><H3>s2_pl_get_spec_l</H3></A>
<PRE>public function s2_pl_get_spec_l (pl, l) result (pl_val)
    type (s2_pl), intent(in) :: pl
    integer, intent(in) :: l
    real (kind=s2_sp) :: pl_val
    ! Calls: s2_error
end function s2_pl_get_spec_l
</PRE>
 Get spectrum value for a given l from the pl.
<P>
 Variables:
   <UL>
   <LI>  pl: Pl object to get the variable of.
   <LI>  l: l value to get value of.
   <LI>  pl_val: Spectrum value for specified l.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
</HTML>
