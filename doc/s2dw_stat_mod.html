<HTML>
<HEAD>
   <TITLE> module s2dw_stat_mod (generated by f90doc) </TITLE>
  <LINK rel="stylesheet" href="stylesheet.css" type="text/css" /> </HEAD>
<H1> Module s2dw_stat_mod </H1>
<PRE>module s2dw_stat_mod

        ! Uses
    use <A HREF="s2dw_types_mod.html">s2dw_types_mod</A>
    use <A HREF="s2dw_error_mod.html">s2dw_error_mod</A>
    use <A HREF="s2dw_core_mod.html">s2dw_core_mod</A>
    use <A HREF="omp_lib.html">omp_lib</A>

        ! Subroutines and functions
    public subroutine <A HREF="s2dw_stat_mod.html#subroutine_s2dw_stat_moments">s2dw_stat_moments</A> (wavdyn, J, B, N, alpha, mean, var, skew, kur, wavdyn_mask, five, six)
    public subroutine <A HREF="s2dw_stat_mod.html#subroutine_s2dw_stat_moments_write">s2dw_stat_moments_write</A> (filename, nsim, description, J, mu, var, skew, kur, five, six)
    public subroutine <A HREF="s2dw_stat_mod.html#subroutine_s2dw_stat_histogram">s2dw_stat_histogram</A> (wavdyn, J, B, N, alpha, hist_nbins, hist_bins, hist_vals)
    public subroutine <A HREF="s2dw_stat_mod.html#subroutine_s2dw_stat_histogram_write">s2dw_stat_histogram_write</A> (filename, J, hist_nbins, hist_bins, hist_vals)

end module s2dw_stat_mod
</PRE>
 Functionality to compute statistics of wavelet coefficients.
<P>
<STRONG>Author:</STRONG> J. D. McEwen (mcewen@mrao.cam.ac.uk)
<P>
<STRONG>Version:</STRONG> 0.1 February 2012

<HR><H2> Description of Subroutines and Functions </H2>
<A NAME="subroutine_s2dw_stat_moments"><H3>s2dw_stat_moments</H3></A>
<PRE>public subroutine s2dw_stat_moments (wavdyn, J, B, N, alpha, mean, var, skew, kur, wavdyn_mask, five, six)
    type (s2dw_wav_abg), intent(inout), dimension (0:J) :: wavdyn
    integer, intent(in) :: J
    integer, intent(in) :: B
    integer, intent(in) :: N
    real (kind=dp), intent(in) :: alpha
    real (kind=dp), intent(out), dimension (0:J) :: mean
    real (kind=dp), intent(out), dimension (0:J) :: var
    real (kind=dp), intent(out), dimension (0:J) :: skew
    real (kind=dp), intent(out), dimension (0:J) :: kur
    type (s2dw_wav_abg), optional, intent(in), dimension (0:J) :: wavdyn_mask
    real (kind=dp), optional, intent(out), dimension (0:J) :: five
    real (kind=dp), optional, intent(out), dimension (0:J) :: six
    ! Calls: s2dw_error
end subroutine s2dw_stat_moments
</PRE>
 Compute moments of wavelets coefficients for each scale,
 including the mean, variance, skewness and kurtosis. The fifth- and 
 sixth-order standardized moments can also be optionally returned.
<P>
 Notes:
  <UL>
  <LI>  Memory for the computed moments must already be allocated by the 
    calling routine.
<P>
  </UL>
 Variables:
  <UL>
  <LI>  wavdyn(0:J)%coeff: Wavelet coefficients for each scale
    [input/ouput].  On ouput the wavelet coefficients will be
    masked if a mask was passed when calling this function.
  <LI>  J: Maximum analysis scale depth [input].
  <LI>  B: Harmonic band limit [input].
  <LI>  N: Azimuthal band limit [input].
  <LI>  bl_scoeff: Upper band limit for scaling coefficients [input].
  <LI>  alpha: Basis dilation factor [input].
  <LI>  mean(0:J): Mean of wavelet coefficients for each scale [output].
  <LI>  var(0:J): Variance of wavelet coefficients for each scale [output].
  <LI>  skew(0:J): Skewness of wavelet coefficients for each scale [output].
  <LI>  kur(0:J): Excess kurtosis of wavelet coefficients for each scale [output].
  <LI>  wavdyn_mask(0:J)%coeff: Binary mask defined in the wavelet
    domain (values of zero and one indicate wavelet coefficient
    are ignored and included, respectively, in the calculation
    of moments) [input].
  <LI>  five(0:J): Fifth-order moment of wavelet coefficients for each 
               scale [output].
  <LI>  six(0:J): Excess sixth-order moment of wavelet coefficients for 
              each scale [output].
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 February 2012
<A NAME="subroutine_s2dw_stat_moments_write"><H3>s2dw_stat_moments_write</H3></A>
<PRE>public subroutine s2dw_stat_moments_write (filename, nsim, description, J, mu, var, skew, kur, five, six)
    character (len=*), intent(in) :: filename
    integer, intent(in) :: nsim
    character (len=STRING_LEN), intent(in), dimension (0:nsim-1) :: description
    integer, intent(in) :: J
    real (kind=dp), intent(in), dimension (0:nsim-1,0:J) :: mu
    real (kind=dp), intent(in), dimension (0:nsim-1,0:J) :: var
    real (kind=dp), intent(in), dimension (0:nsim-1,0:J) :: skew
    real (kind=dp), intent(in), dimension (0:nsim-1,0:J) :: kur
    real (kind=dp), optional, dimension (0:nsim-1,0:J) :: five
    real (kind=dp), optional, dimension (0:nsim-1,0:J) :: six
end subroutine s2dw_stat_moments_write
</PRE>
 Write moments of wavelets coefficients for each scale, including
 the mean, variance, skewness and kurtosis.  Moments are written
 to a single line (ordered mean, variance, skewness and kurtosis)
 for each set of wavelet coefficients. Fifth and sixth order standardized
 moments can also be optionally included.
<P>
 Variables:
  <UL>
  <LI>  filename: Name of file to write wavelet coefficient moments to 
    [input].
  <LI>  nsim: Number of sets of wavelet coefficient moments, i.e. number 
    of skies/maps analysed [input].
  <LI>  description(0:nsim-1): Description of each set of wavelet
    coefficients stats, typically a filename [input].
  <LI>  J: Maximum analysis scale depth [input].
  <LI>  mean(0:nsim-1,0:J): Mean of wavelet coefficients for each map
    and scale [input].
  <LI>  var(0:nsim-1,0:J): Variance of wavelet coefficients for each
    map and scale [input].
  <LI>  skew(0:nsim-1,0:J): Skewness of wavelet coefficients for each
    map and scale [input].
  <LI>  kur(0:nsim-1,0:J): Excess kurtosis of wavelet coefficients for each
    map and scale [input].
  <LI>  five(0:J): Fifth-order moment of wavelet coefficients for each 
               scale [input].
  <LI>  six(0:J): Excess sixth-order moment of wavelet coefficients for 
              each scale [input].
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 February 2012
<A NAME="subroutine_s2dw_stat_histogram"><H3>s2dw_stat_histogram</H3></A>
<PRE>public subroutine s2dw_stat_histogram (wavdyn, J, B, N, alpha, hist_nbins, hist_bins, hist_vals)
    type (s2dw_wav_abg), intent(in), dimension (0:J) :: wavdyn
    integer, intent(in) :: J
    integer, intent(in) :: B
    integer, intent(in) :: N
    real (kind=dp), intent(in) :: alpha
    integer, intent(in) :: hist_nbins
    real (kind=dp), intent(out), dimension (0:J,0:hist_nbins-1) :: hist_bins
    integer, intent(out), dimension (0:J,0:hist_nbins-1) :: hist_vals
    ! Calls: s2dw_error
end subroutine s2dw_stat_histogram
</PRE>
 Compute histogram of wavelets coefficients for each scale.
<P>
 Notes:
  <UL>
  <LI>  Memory for the computed histograms must already be allocated by the 
    calling routine.
<P>
  </UL>
 Variables:
  <UL>
  <LI>  wavdyn(0:J)%coeff: Wavelet coefficients for each scale [input].
  <LI>  J: Maximum analysis scale depth [input].
  <LI>  B: Harmonic band limit [input].
  <LI>  N: Azimuthal band limit [input].
  <LI>  alpha: Basis dilation factor [input].
  <LI>  hist_nbins: Number of histogram bins [input].
  <LI>  hist_bins(0:J,0:hist_nbins-1): Central position of each bin [input].
  <LI>  hist_vals(0:J,0:hist_nbins-1): Count in each bin [output].
  </UL>
<P>
<STRONG>Author:</STRONG> S. M. Feeney
<P>
<STRONG>Version:</STRONG> 0.1 February 2012
<A NAME="subroutine_s2dw_stat_histogram_write"><H3>s2dw_stat_histogram_write</H3></A>
<PRE>public subroutine s2dw_stat_histogram_write (filename, J, hist_nbins, hist_bins, hist_vals)
    character (len=*), intent(in) :: filename
    integer, intent(in) :: J
    integer, intent(in) :: hist_nbins
    real (kind=dp), intent(in), dimension (0:J,0:hist_nbins-1) :: hist_bins
    integer, intent(in), dimension (0:J,0:hist_nbins-1) :: hist_vals
end subroutine s2dw_stat_histogram_write
</PRE>
 Write histograms of wavelets coefficients for each scale. The first line
 of output contains the j = 0 bins, the second line contains the j = 0
 bin counts and so on.
<P>
 Variables:
  <UL>
  <LI>  filename: Name of file to write wavelet coefficient moments to 
    [input].
  <LI>  nsim: Number of sets of wavelet coefficient moments, i.e. number 
    of skies/maps analysed [input].
  <LI>  J: Maximum analysis scale depth [input].
  <LI>  hist_nbins: Number of histogram bins [input].
  <LI>  hist_bins(0:J,0:hist_nbins-1): Central position of each bin [input].
  <LI>  hist_vals(0:J,0:hist_nbins-1): Count in each bin [input].
  </UL>
<P>
<STRONG>Author:</STRONG> S. M. Feeney
<P>
<STRONG>Version:</STRONG> 0.1 February 2012
</HTML>
